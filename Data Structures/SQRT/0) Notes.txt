//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



/* SQRT */
(1)



//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



/* MO */
(1) Time complexity of k-MO is O(n * q^(1 - (1/k))), where SQ = n/q^(1/k)
(2) take care when compress with update --> the number of distinct elements can be 2*n
(3)



//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



// compression trick
void apply_compression()
{
    map < ll, ll > mp;
    for(ll i = 0; i <= n; i++)
    {
        mp[a[i] + k];
        mp[a[i]];
        mp[a[i] - k];
    }

    ll curr = 0;
    for(auto &i : mp) i.second = curr++;

    for(ll i = 0; i <= n; i++)
    {
        up[i] = mp[a[i] + k];
        middle[i] = mp[a[i]];
        down[i] = mp[a[i] - k];
    }
}



//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



// This is a sqrt-decomposition frequency structure that supports:
//   • insert(x) in O(1)
//   • erase(x) in O(1)
//   • kth(k): return the k-th smallest value currently present in O(√N)
//



const ll _N = 1 << 18, _K = 1 << 10;
struct DS
{
    ll big[_N/_K], small[_N];

    void insert(ll x)
    {
        small[x]++;
        big[x >> 10]++;
    }
    void erase(ll x)
    {
        small[x]--;
        big[x >> 10]--;
    }

    ll kth(ll k)
    {
        k--;
        ll cur=0;
        while(big[cur] <= k) k -= big[cur++];
        cur <<= 10;
        while(small[cur] <= k) k -= small[cur++];

        return cur;
    }
} ds;



//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
